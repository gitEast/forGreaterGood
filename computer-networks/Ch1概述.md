<!--
 * @Author: East
 * @Date: 2022-03-09 21:12:49
 * @LastEditTime: 2022-03-14 21:03:28
 * @LastEditors: Please set LastEditors
 * @Description:
                 1. 互连网边缘部分和核心部分的作用
                 2. 计算机网络的性能指标
                 3. 计算机网络分层次的体系结构
 * @FilePath: \forGreaterGood\computer-networks\Ch1概述.md
-->

# Ch1. 概述

## 1. 计算机网络在信息时代的作用

- 计算机网络已由一种**通信基础设施**发展成为一种重要的\*\*信息服务基础设施
- 计算机网络已经像水、电、煤气这些基础设施一样，成为我们\*\*生活中不可或缺的一部分

[中国互联网络信息中心](https://www.cnnic.net.cn)

## 2. 因特网概述

### 2.1 网络、互连网(互联网)和因特网

- 网络：由若干结点 Node 和连接这些结点的链路 Link 组成
- 互联网：多个网络还可以通过路由器互连起来，这样就构成了一个覆盖范围更大的网络，即互连网。因此，互连网是“网络的网络 Network of Networks”
- 因特网：是世界上最大的互连网络（用户数以亿计，互连的网络数以百万计

* internet 与 Internet 的区别
  - internet(互连网)是一个通用名词，它泛指由多个计算机网络互连而成的网络。在这些网络之间的通信协议是可以任意的。
  - Internet(因特网)则是一个专用名词，它指当前全球最大的、开放的、由众多网络互相连接而成的特定计算机网络，采用 TCP/IP 协议族作为通信的规则。其前身是美国的 ARPANET

### 2.2 因特网发展的三个阶段

![发展阶段](../computer-networks/imgs/Ch1_%E5%8F%91%E5%B1%95%E9%98%B6%E6%AE%B5.png)

1. 从单个网络 ARPANET 向互联网发展
   1. 1969 年，第一个分组交换网 ARPANET
   2. 70 年代中期，研究多种网络之间的互连
   3. 1983 年，TCP/IP 协议成为 ARPANET 的标准协议(因特网诞生时间)
2. 逐步建成三级结构的因特网
   1. 1985 年， NSF 围绕六个大型计算机中心建设 NSFNET (主干网、地区网和校园网)
   2. 1990 年，ARPANET 任务完成，正式关闭
   3. 1991 年，美国政府将因特网主干网交给私人公司经营，并开始对接入因特网的单位收费
3. 逐步形成了多层次 ISP 结构的因特网
   1. 1992 年，NSFNET 逐渐被若干个商用因特网主干网替代；政府机构不再负责因特网运营，让各种**因特网服务提供者 ISP**来运营
   2. 1994 年，万维网 WWW 计数促使因特网迅猛发展
   3. 1995 年，NSFNET 停止运作，**因特网彻底商业化**

- 因特网服务提供者 ISP (Internet Service Provider)
  - 我国
    1. 电信
    2. 联通
    3. 移动
  - 基于 ISP 的三层结构的因特网 ![图](./imgs/Ch1_ISP%E4%B8%89%E5%B1%82%E7%BB%93%E6%9E%84%E5%9B%A0%E7%89%B9%E7%BD%91.png)
  - 一个 ISP 可以很方便地在因特网拓扑上增添新的层次和分支

### 2.3 因特网的标准化工作

- 因特网的标准工作对因特网的发展起到了非常重要的作用
- 因特网在制定其标准上的一个很大的特点是**面向公众**
  - 因特网所有的 RFC(Request For Comments) 技术文档都可以从因特网上免费下载 [网址](http://www.ietf.org.rfc.html)
  - 任何人都可以随时用电子邮件发表对某个文档的意见或建议
- **因特网协会 ISOC** 是一个国际性组织，它负责对因特网进行全面管理，以及在世界范围内促进其发展和使用 ![结构图](./imgs/Ch1_ISOC%E7%BB%93%E6%9E%84.png)
  - 因特网体系结构委员会 IAB，负责管理因特网有关协议的开发
  - 因特网工程部 IETF，负责研究中短期工程问题，主要针对协议的开发和标准化
  - 因特网研究部 IRTF，从事理论方面的研究和开发一些需要长期考虑的问题 v
- 指定因特网的正式标准要经过以下 4 个阶段：
  1. 因特网草案(这时候还不是 RFC 文档)
  2. 建议标准(开始成为 RFC 文档)
  3. 草案标准
  4. 因特网标准

### 2.4 因特网的组成

- 边缘部分
  - 由所有连接在因特网上的**主机**组成
  - 这部分是用户直接使用的，用来进行**通信(传送数据、音频或视频)和资源共享**
- 核心部分
  - 由**大量网络**和连接这些网络的**路由器**组成
  - 这部分是为边缘部分提供服务的(**连通性和交换**)

## 3. 三种交换方式

### 3.1 电路交换 Circuit Switching

![图解](./imgs/Ch1_%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2.png)

- 电话交换机接通电话线的方式称为电路交换 ![图解](./imgs/Ch1_%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2%E5%85%B7%E4%BD%93.png)
- 从通信资源的分配角度来看，交换(Switching)就是按照某种方式动态地分配传输路线的资源
- 电路交换的三个步骤：
  1. 建立连接(分配通信资源)
  2. 通话(一直占用通信资源)
  3. 释放连接(归还通信资源)

### 3.2 分组交换 Packet Switching

- 发送方
  - 构造分组
  - 发送分组
- 路由器
  - 缓存分组
  - 转发分组
- 接收方
  - 接收分组
  - 还原报文

### 3.3 报文交换 Message Switching

- 也使用存储转发
  - 但对报文大小没有限制
- 主要用于早期的电报通信网

### 3.4 总结

![图解](./imgs/Ch1_%E4%BA%A4%E6%8D%A2%E6%96%B9%E5%BC%8F%E6%AF%94%E8%BE%83.png)

- 电路交换
  - 优点：
    1. 通信时延小
    2. 有序传输
    3. 没有冲突
    4. 适用范围广：数字信号和模拟信号都可以
    5. 实时性强：得益于通信时延小
    6. 控制简单
  - 缺点：
    1. 建立连接时间长
    2. 线路独占，使用效率低
    3. 灵活性差：if 物理通道中某一点出现问题，必须重新建立连接，对紧急和重要的通信不友好
    4. 难以规格化
- 报文交换
  - 优点：
    1. 无需建立连接
    2. 动态分配线路
    3. 提高线路可靠性
    4. 提高线路利用率
    5. 提供多目标服务
  - 缺点：
    1. 引起转发时延
    2. 需要较大的存储缓存空间
    3. 需要传输额外的信息量：需要携带目标地址、源地址等信息
- 分组交换
  - 优点：
    1. 无需建立连接
    2. 线路利用率高
    3. 简化了存储管理
    4. 加速传输
    5. 减少出错概率和重发数据量
  - 缺点：
    1. 引起转发时延
    2. 需要传输额外的信息量：报文分割出来的每个数据块都需要携带目标地址、源地址等信息
    3. 对于数据包服务，存在失序、丢失或重复分组的问题；对于虚电路服务，存在呼叫建立、数据传输和虚电路释放三个过程

## 4. 计算机网络的定义

- 计算机网络的精确定义并未统一
- 计算机网络的最简单的定义：一些**互相连接**的、**自治**的计算机的**集合**
  - 互连：指计算机之间可以通过有线或无线的方式进行数据通信
  - 自治：指独立的计算机，它有自己的硬件和软件，可以单独运行使用
  - 集合：指至少需要两台计算机
- 计算机网络的较好的定义：计算机网络主要是由一些**通用的、可编程的硬件互连**而成的，而这些硬件并非专门用来实现某一特定目的(如，传送数据或视频信号)。这些可编程的硬件能够用来**传送多种不同类型的数据**，并能**支持广泛的和日益增长的应用**
  - 计算机网络所连接的硬件，并不限于一般的计算机，而是包括了智能手机等智能硬件
  - 计算机网络并非专门用来传输数据，而是能够支持很多种的应用(包括今后可能出现的各种应用)

### 4.1 计算机网络分类

- 按交换技术分类
  - 电路交换网络
  - 报文交换网络
  - 分组交换网络
- 按使用者分类
  - 公用网
  - 专用网
- 按传输介质分类
  - 有线网络
  - 无线网络
- 按覆盖范围分类
  - 广域网 WAN
    - 远程网
    - 因特网的核心
  - 城域网 MAN
    - 覆盖范围一般是一个城市 or 几个城市
    - 互连大量企业、机构和校园局域网
  - 局域网 LAN
    - 距离一般在 1 公里内
  - 个域网 PAN
    - 覆盖范围大约为 10 米
- 按拓扑结构分类
  - 总线型网络
  - 星型网络
  - 环型网络
  - 网状型网络

## 5. 计算机网络的性能指标

### 5.1 速率

- 比特
  - 计算机中**数据量的单位**，也是信息论中信息量的单位。一个比特就是二进制数字中的一个 1 or 0
  - 单位 ![图](./imgs/Ch1_%E6%AF%94%E7%89%B9.png)
- 速率
  - 连接在计算机网络上的主机在数字信道上传送比特的速率，也成为**比特率** or **数据率**
  - 单位 ![图](./imgs/Ch1_%E9%80%9F%E7%8E%87.png)

### 5.2 带宽

- 带宽在模拟信号系统中的意义
  - 信号所包含的各种不同频率成分所占据的**频率范围**
  - 单位：Hz(kHz, MHz, GHz)
- 带宽在计算机网络中的意义
  - 用来表示网络的**通信线路**所能传送的数据的能力，因此网络带宽表示在单位时间内从网络中的某一点到零一点所能通过的**最高数据率**
  - 单位：b/s(kb/s, Mb/s, Gb/s, Tb/s)
- 一条通信线路的“频带宽度”越宽，其所传输数据的“最高数据率”也越高

### 5.3 吞吐量

- 吞吐量表示在**单位时间内通过某个网络(or 信道、接口)的数据量**
- 吞吐量被经常用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络
- 吞吐量**受网络的带宽 or 额定速率的限制**

### 5.4 时延

![图解](./imgs/Ch1_%E6%97%B6%E5%BB%B6.png)

- 网络时延(由以下三部分组成)
  - 发送时延
    - 分组长度(b) / 发送速率(b/s)
  - 传播时延
    - 信道长度(m) / 电磁波传播速率(m/s)
      - 自由空间 电磁波传播速率：3 \* 10e8
      - 铜线 电磁波：2.3 \* 10e8
      - 光纤 电磁波：2.0 \* 10e8
  - 处理时延
    - 将 排队时延 也包括在内

### 5.5 时延带宽积

时延带宽积 = 传播时延 \* 带宽

- 若发送端连续发送数据，则在所发送的第一个比特即将到达终点时，发送端就已经发送了 时延带宽积 个 比特
- 链路的时延带宽积又称为**以比特为单位的链路长度**

### 5.6 往返时间

- 在很多情况下，因特网上的信息不仅仅单方向传输，而是双向交互
- 我们有时很需要知道双向交互一次所需的时间
- 因此，**往返时间 RTT(Round-Trip Time)** 也是一个重要的性能指标
  - 指 源主机发送分组到目的主机 + 源主机收到目的主机确认分组的信息 的时间

### 5.7 利用率

- 分为两类
  - 信道利用率：用来表示某信道有百分之几的时间是被利用的(有数据通过)
  - 网络利用率：全网络的信道利用率的加权平均
- 根据**排队**论，当某信道的利用率增大时，该信道引起的时延也会迅速增加
  - 因此信道利用率并非越高越好
    - 时延与信道利用率的计算公式 ![图](./imgs/Ch1_%E6%97%B6%E5%BB%B6%E4%B8%8E%E4%BF%A1%E9%81%93%E5%88%A9%E7%94%A8%E7%8E%87%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F.png) ![时延与信道利用率关系图解](./imgs/Ch1_%E6%97%B6%E5%BB%B6%E4%B8%8E%E4%BF%A1%E9%81%93%E5%88%A9%E7%94%A8%E7%8E%87%E5%85%B3%E7%B3%BB%E5%9B%BE%E8%A7%A3.png)
  - 但也**不能使信道利用率太低，这会使宝贵的通信资源被白白浪费**。应该使用一些机制，可以根据情况动态调整输入到网络中的通信量，使网络利用率保持在一个合理的范围内

### 5.8 丢包率

丢包率即分组丢失率，是指在一定的时间范围内，传输过程中**丢失的分组数量与总分组数量的比率**

- 分类
  - 接口丢包率
  - 结点丢包率
  - 链路丢包率
  - 路径丢包率
  - 网络丢包率
  - ...

丢包率是网络运维人员非常关心的一个网络性能指标，但对于普通用户来说往往不关心这个指标，因为他们通常意识不到网络丢包。

- 分组丢失主要有两种情况
  1. 分组在传输过程中出现**误码**，被结点丢弃
  2. 分组到达一台队列已满的分组交换机时被丢弃，在通信量较大时就可能造成网络拥塞
- 因此，丢包率反映了网络的拥塞状况：
  1. 无拥塞时，路径丢包率为 0
  2. 轻度拥塞时路径丢包率为 1% ~ 4%
  3. 严重拥塞时，路径丢包率为 5% ~ 15%

## 6. 计算机网络体系结构

### 6.1 常见的计算机网络体系结构

![图](./imgs/Ch1_%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B.png)

1. OSI 体系结构失败的原因：
   1. OSI 专家没有相关的商业驱动力
   2. OSI 协议实现起来过分复杂，而且运行效率很低
   3. OSI 标准指定的周期太长，因而使符合标准的设备太迟进入市场
   4. 层次划分不合理，某些功能在不同层次中多次出现
2. TCP/IP 体系结构：
   1. 为了方便对不同设备进行兼容，网络接口层不做统一的标准规定
   2. IP 协议的重要性：
      - 使用 IP 协议互连不同的网络接口 IP over everything
      - IP 协议可以为各种网络应用提供服务 Everything over IP
3. 原理体系结构：
   1. 一种折中的办法

### 6.2 计算机网络体系结构分层的必要性

- 理由：(分而治之)
  1. **计算机网络是个非常复杂的系统。**早在最初的 ARPANET 设计时就提出了分层的设计理念
  2. **分层** 可将庞大而复杂的问题，转化为若干较小的局部问题，而这些较小的局部问题就比较易于研究和处理
- 实现计算机网络要面临的主要问题 与 如何将这些问题规划到相应的层次并处理：(由简单到复杂的顺序)
  1. 物理层：最简单的情况 ![两台主机互连](./imgs/Ch1_%E7%89%A9%E7%90%86%E5%B1%82.png)
     - 采用怎样的传输媒体(介质)：网线 + 网线接口
     - 使用怎样的信号表示比特 0 和 1：方波信号(实际并不是，只是为了举例说明)
  2. 数据链路层：总线型网络 ![图](./imgs/Ch1_%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%821.png)
     - 如何标识网络中的各主机：主机编址问题，如 MAC 地址
     - 如何从信号所表示的一连串比特流中区分出地址和数据
     - 如何协调各主机争用总线
     - 实际上总线型网络已经被淘汰，现在使用其他网络拓扑结构 ![图](./imgs/Ch1_%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%822.png)
  3. 网络层：![图](./imgs/Ch1_%E7%BD%91%E7%BB%9C%E5%B1%82.png)
     - 如何标识各网络以及网络中的各主机：网络和主机共同编址的问题，例如 IP 地址
     - 路由器如何转发分组，如何进行路由选择？
  4. 运输层：![图](./imgs/Ch1_%E8%BF%90%E8%BE%93%E5%B1%82.png)
     - 如何解决进程之间基于网络的通信问题
     - 出现传输错误时，如何处理：误码 + 丢包
  5. 应用层：![图](./imgs/Ch1_%E5%BA%94%E7%94%A8%E5%B1%82.png)
     - 通过应用进程间的交互来完成特定的网络应用：
       - 支持万维网应用的 HTTP 协议
       - 支持电子邮件的 SMTP 协议
       - 支持文件传送的 FTP 协议
- 总结 ![图](./imgs/Ch1_%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90.png)

### 6.3 计算机网络体系结构分层思想举例

![计算机网络体系结构分层思想举例](./imgs/Ch1_%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%88%86%E5%B1%82%E6%80%9D%E6%83%B3.png)

- 应用层：HTTP 请求报文 ![HTTP 请求报文](./imgs/Ch1_HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87.png)
- 运输层：TCP 报文段 HTTP + TCP ![TCP 报文段](./imgs/Ch1_TCP%E6%8A%A5%E6%96%87%E6%AE%B5.png)
  - 区分应用进程
  - 实现可靠传输
- 网络层：IP 数据报 HTTP + TCP + IP ![IP 数据报](./imgs/Ch1_IP%E6%95%B0%E6%8D%AE%E6%8A%A5.png)
  - 使 IP 数据报可以在互联网上传输
- 数据链路层：帧 ETH + HTTP + TCP + IP + ETH ![帧](./imgs/Ch1_%E5%B8%A7.png)
  - 首部帧 -> 使 帧 能够在 一段链路 or 一个网络 传输，或者被相应的主机接收
  - FCS 检查收到的帧是否有误码
- 物理层：比特流 ![比特流](./imgs/Ch1_%E6%AF%94%E7%89%B9%E6%B5%81.png)
  - 前导码：让目的主机做好接收帧的准备
  - 将 添有前导码的比特流 变换成 相应的信号 发送给下一个地方

### 6.4 计算机网络体系结构中的专用术语

> 这些专用术语来自于 OSI 的七层体系结构，但也适用于 TCP/IP 的四层体系结构 和 五层协议原理体系结构

1. 实体：任何可发送或接收信息的**硬件**或**软件进程**
   - 对等实体：收发双方**相同层次中的实体**
2. 协议
   - 控制两个对等实体进行逻辑通信的规则的集合
     - 逻辑通信：实际不存在，便于理解而不用顾及其他层
   - 三要素
     1. 语法：定义所交换信息的格式
     2. 语义：定义收发双方所要完成的操作
     3. 同步：定义收发双发的时序关系(并非始终频率同步) ![例子](./imgs/Ch1_%E5%8D%8F%E8%AE%AE_%E5%90%8C%E6%AD%A5.png)
3. 服务
   - 解析：![图解](./imgs/Ch1_%E6%9C%8D%E5%8A%A1.png)
     1. 在协议的控制下，两个对等实体间的逻辑通信使得本层能够想上一层提供服务
     2. 要实现本层协议，还需要使用下面一层所提供的服务
     3. 协议是“**水平**”的，服务是“**垂直**”的
     4. 实体看得见相邻下层所提供的服务，但并不知道实现该服务的具体协议。也就是说，下面的协议对上面的实体是“**透明**”的
   - 服务访问点：
     - 在同一系统中**相邻两层的实体交换信息的逻辑接口**，用于区分不同的服务类型
     - 不同服务类型：
       - 数据链路层的服务访问点为 帧 的“类型”字段
       - 网络层：IP 数据报首部中的“协议字段”
       - 运输层：端口号
   - 服务原语：
     - 上层使用下层所提供的服务必须通过与下层交换一些命令，这些命令称为服务原语
   - 数据单元 ![图解](./imgs/Ch1_%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83.png)
     - 协议数据单元 PDU：**对等层次之间栓送的数据包** 称为 该层的协议数据单元
     - 服务数据单元 SDU：**同一系统内，层与层之间交换的数据包** 称为 服务数据单元
     - 多个 SDU 可以合为一个 PDU，一个 SDU 也可划分为几个 PDU

## 7. 章节概述

## 8. 课后习题

- 题目

  1. 在 OSI 参考模型中，自下而上第一个提供端到端服务的层次是（ ）
     A. 数据链路层 B. 传输层 C. 会话层 D. 应用层
  2. 下列选项中，不属于网络体系结构所描述的内容是（ ）
     A. 网络的层次 B. 每一层使用的协议 C. 协议的内部实现细节 D. 每一层必须完成的功能
  3. TCP/IP 参考模型的网络层提供的是（ ）
     A. 无连接不可靠的数据报服务 B. 无连接可靠的数据报服务 C. 有连接不可靠的虚电路服务 D. 有连接可靠的虚电路服务
  4. 在 TCP/IP 体系结构中，直接为 ICMP 提供服务的协议是（ ）
     A. PPP B. IP C. UDP D. TCP
  5. 在 OSI 参考模型中，下列功能需要由应用层的相邻层实现的是（ ）
     A. 对话管理 B. 数据格式转换 C. 路由选择 D. 可靠数据传输
  6. 在 OSI 参考模型中，直接为会话层提供服务的是（ ）
     A. 应用层 B. 表示层 C. 传输层 D. 网络层
  7. 通过 POP3 协议接收邮件时，使用的传输层服务类型是（ ）
     A. 无连接不可靠的数据传输服务 B. 无连接可靠的数据传输服务 C. 有连接不可靠的数据传输服务 D. 有连接可靠的数据传输服务
  8. 在 OSI 参考模型中，R1, Switch, Hub 实现的最高功能层分别是（ ）![图](./imgs/Ch1_%E9%97%AE%E9%A2%988.png)
     A. 2、2、1 B. 2、2、2 C. 3、2、1 D. 3、2、2
  9. 假设 OSI 参考模型的应用层欲发送 400B 的数据(无拆分)，除物理层和应用层之外，其他各层在封装 PDU 时均引入 20B 的额外开销，则应用层数据传输效率约为（ ）
     A. 80% B. 83% C. 87% D. 91%
  10. 下列 TCP/IP 应用层协议中，可以使用传输层无连接的是（ ）
      A. FTP B. DNS C. SMTP D. HTTP

- 解析
  1. B，注意 **端到端**服务
     - 各层主要任务：
       1. 物理层：解决使用何种信号来传输比特 0 和 1 的问题
       2. 数据链路层：解决分组在一个网络(or 一段链路)上传输的问题
       3. 网络层：解决分组在多个网络之间传输(路由)的问题
       4. 运输层：解决进程之间基于网络的通信问题
       5. 会话层：解决进程之间进行会话问题
       6. 表示层：解决通信双方交换信息的表示问题
       7. 应用层：解决通过应用进程之间的交互来实现特定网络应用的问题
     - 图解 ![图解](./imgs/Ch1_%E9%97%AE%E9%A2%981.png)
  2. C
     - 计算机网络的体系结构就是计算机网络及其构件所应完成的功能的精确定义
     - 需要强调的是：这些功能的实现细节(例如采用何种硬件 or 软件)，则是遵守这种体系结构的具体实现问题，并不属于体系结构本身所描述的内容
       - 类似于 ECMAScript 与 JavaScript
  3. A
  4. B
     - PPP 为网络接口层的协议
  5. B
     - 理由：
       1. OSI 参考模型应用层的相邻层是**表示层**
       2. 表示层的任务是实现与数据表示相关的功能，主要包括数据字符集的转换、数据格式化、文本压缩、数据加密以及解密等工作
     - 其他：
       - A：对话管理 --- 会话层
       - C：路由管理 --- 网络层
       - D：可靠数据传输 --- 运输层 + 数据链路层
  6. C
  7. D
     - 使用 TCP 提供的服务
  8. C
  9. A
     - 400 / (400 + (7 - 2) \* 20) = 80%
  10. B
      - DNS 由 UDP 提供服务
      - UDP 提供无连接服务
